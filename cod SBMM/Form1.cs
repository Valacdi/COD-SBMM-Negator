using System.Collections.ObjectModel;
using System.Diagnostics;
using System.Management.Automation;
using System.Management.Automation.Runspaces;
using System.Security;

namespace cod_SBMM
{
    public partial class Form1 : Form
    {
        private string codMW2019 = "Remove-NetFirewallRule -DisplayName \"warzone_221119\" -ErrorAction SilentlyContinue;\r\nRemove-NetFirewallRule -DisplayName \"220822\" -ErrorAction SilentlyContinue;\r\nNew-NetFirewallRule -DisplayName \"warzone_221119\" -Direction Outbound -Protocol Udp -Action Block -Program ";
        private string codMW2022 = "Remove-NetFirewallRule -DisplayName \"warzone2_221119\" -ErrorAction SilentlyContinue;\r\nRemove-NetFirewallRule -DisplayName \"220822\" -ErrorAction SilentlyContinue;\r\nNew-NetFirewallRule -DisplayName \"warzone2_221119\" -Direction Outbound -Protocol Udp -Action Block -Program ";
        private string codVanguard = "Remove-NetFirewallRule -DisplayName \"vanguard_221119\" -ErrorAction SilentlyContinue;\r\nRemove-NetFirewallRule -DisplayName \"220822\" -ErrorAction SilentlyContinue;\r\nNew-NetFirewallRule -DisplayName \"vanguard_221119\" -Direction Outbound -Protocol Udp -Action Block -Program ";

        public Form1()
        {
            InitializeComponent();
        }

        private void gameComboBox_SelectedIndexChanged(object sender, EventArgs e)
        {
            string selectedGame = gameComboBox.SelectedItem?.ToString();
            string newText = "";

            if (selectedGame == "Call Of Duty Vanguard")
            {
                string filePath = "codVanguardPATH.txt";

                if (File.Exists(filePath))
                {
                    string fileContent = File.ReadAllText(filePath);
                    newText = fileContent;
                }
                else
                {
                    newText = "Paste the path to the game here.";
                }
            }
            else if (selectedGame == "Call Of Duty Modern Warfare / Warzone Caldera")
            {
                string filePath = "codMW1PATH.txt";

                if (File.Exists(filePath))
                {
                    string fileContent = File.ReadAllText(filePath);
                    newText = fileContent;
                }
                else
                {
                    newText = "Paste the path to the game here.";
                }
            }
            else if (selectedGame == "Call Of Duty Modern Warfare 2 / Warzone 2.0")
            {
                string filePath = "codMW2PATH.txt";

                if (File.Exists(filePath))
                {
                    string fileContent = File.ReadAllText(filePath);
                    newText = fileContent;
                }
                else
                {
                    newText = "Paste the path to the game here.";
                }
            }
            else //mw3
            {
                string filePath = "codMW3PATH.txt";

                if (File.Exists(filePath))
                {
                    string fileContent = File.ReadAllText(filePath);
                    newText = fileContent;
                }
                else
                {
                    newText = "Paste the path to the game here.";
                }
            }
            pathToGameTextbox.Text = newText;
        }

        private void enable_button_Click(object sender, EventArgs e)
        {
            string selectedGame = gameComboBox.SelectedItem?.ToString();
            string selectedRegion = regionComboBox.SelectedItem?.ToString();
            string gamePath = pathToGameTextbox.Text?.ToString();

            if (selectedGame == "Call Of Duty Vanguard")
            {
                File.WriteAllText("codVanguardPATH.txt", gamePath);
            }
            else if (selectedGame == "Call Of Duty Modern Warfare / Warzone Caldera")
            {
                File.WriteAllText("codMW1PATH.txt", gamePath);
            }
            else if (selectedGame == "Call Of Duty Modern Warfare 2 / Warzone 2.0")
            {
                File.WriteAllText("codMW2PATH.txt", gamePath);
            }
            else //mw3
            {
                File.WriteAllText("codMW3PATH.txt", gamePath);
            }

            if (string.IsNullOrEmpty(selectedGame) || string.IsNullOrEmpty(selectedRegion) || string.IsNullOrEmpty(gamePath))
            {
                MessageBox.Show("Please fill in all the required fields.");
                return;
            }
            else
            {
                if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(0)) //cod mw3 or mw2, UK and NL
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-23.109.54.0,23.109.54.255-23.109.78.0,23.109.80.255-23.109.84.0,23.109.84.255-24.105.29.75,24.105.29.77-24.105.53.0,24.105.53.255-24.105.55.0,24.105.55.1-31.24.224.0,31.24.224.255-31.186.229.0,31.186.229.255-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-52.0.0.0,53.0.0.0-64.95.100.0,64.95.100.255-67.27.0.0,67.28.0.0-78.129.138.0,78.129.255.255-82.145.41.0,82.145.41.255-82.145.63.0,82.145.63.255-87.117.231.0,87.117.255.255-88.0.186.0,88.202.255.255-94.0.0.0,94.0.0.1-95.154.221.0,95.154.255.255-95.179.204.0,95.179.207.255-104.238.169.0,104.238.169.255-109.123.102.0,109.123.102.255-109.169.0.0,109.169.255.255-109.200.30.0,109.200.30.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-173.236.69.0,173.236.69.255-176.227.219.0,176.227.219.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-185.80.223.0,185.80.223.255-185.254.70.0,185.254.70.255-192.168.0.0,192.170.0.0-198.20.103.0,198.20.103.255-212.78.0.0,212.78.0.255-212.78.82.0,212.78.83.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(1)) //cod mw3 or mw2, UK and GER
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-31.24.224.0,31.24.224.255-31.186.229.0,31.186.229.255-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,35.244.54.255-40.1.1.1,41.0.0.0-45.63.118.0,45.63.118.255-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-78.129.138.0,78.129.255.255-82.145.41.0,82.145.41.255-82.145.63.0,82.145.63.255-85.195.79.0,85.195.120.255-87.117.231.0,87.117.231.255-88.0.186.0,88.202.186.255-94.0.0.0,94.0.0.1-95.154.221.0,95.154.255.255-95.179.204.0,95.179.205.255-99.86.245.0,99.86.245.255-104.238.169.0,104.238.169.255-107.152.106.113,107.152.106.115-109.123.102.0,109.123.102.255-109.169.0.0,109.169.255.255-109.200.30.0,109.200.30.255-134.119.100.0,134.119.255.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-146.0.228.0,146.0.255.255-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-173.244.0.0,173.245.213.255-176.227.219.0,176.227.219.255-185.19.215.254,185.19.215.255-185.19.216.0,185.19.216.255-185.19.219.0,185.19.219.255-185.34.0.0,185.80.0.0-185.80.223.0,185.80.223.255-185.225.208.0,185.225.212.255-192.168.0.0,192.170.0.0-212.78.0.0,212.78.0.255-212.78.82.0,212.78.83.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(2)) //cod mw3 or mw2, GER and FR
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-31.186.229.0,31.186.229.255-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.0.0,37.244.255.255-40.1.1.1,41.0.0.0-45.63.102.0,45.63.114.255-45.63.118.0,45.63.118.255-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-85.195.79.0,85.195.120.255-87.117.231.0,87.117.231.0-92.42.110.0,92.42.111.255-92.204.186.0,92.204.187.255-94.0.0.0,94.0.0.1-108.61.237.0,108.61.237.255-134.119.100.0,134.119.255.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-146.0.200.0,148.0.0.0-149.255.255.255,150.0.0.0-151.106.16.0,151.106.16.255-173.244.0.0,173.245.213.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-185.136.0.0,185.136.168.255-192.168.0.0,192.170.0.0-212.39.68.0,212.39.68.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(3)) //cod mw3 or mw2, FR and NL
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,24.105.29.77-24.105.53.0,24.105.53.255-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-40.1.1.1,41.0.0.0-45.63.102.0,45.63.114.0-46.23.78.0,46.23.78.255-52.0.0.0,53.0.0.0-64.95.100.0,64.95.100.255-67.27.0.0,67.28.0.0-72.26.219.0,72.26.219.255-72.251.246.22,72.251.246.255-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-92.42.110.0,92.42.111.255-92.204.186.0,92.204.187.255-94.0.0.0,94.0.0.1-107.6.136.0,107.6.255.255-108.61.122.0,108.61.122.255-108.61.237.0,108.61.237.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-142.91.15.0,142.91.15.255-147.255.255.255,146.0.245.0-146.0.245.255,148.0.0.0-149.255.255.255,150.0.0.0-151.106.16.0,151.106.16.255-172.255.15.0,172.255.15.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-185.136.0.0,185.136.168.0-185.254.68.0,185.254.68.255-192.168.0.0,192.170.0.0-198.20.103.0,198.20.103.255-206.191.156.0,206.191.156.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(4)) //cod mw3 or mw2, GER and NL
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.53.0,24.105.53.255-24.105.55.0,24.105.55.1-31.186.229.0,31.186.229.255-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.0.0,37.244.255.255-40.1.1.1,41.0.0.0-45.63.118.0,45.63.118.255-46.23.78.0,46.23.78.255-52.0.0.0,53.0.0.0-64.95.100.0,64.95.100.255-67.27.0.0,67.28.0.0-72.26.219.0,72.26.219.255-72.251.246.22,72.251.246.255-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-85.195.79.0,85.195.120.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-107.6.136.0,107.6.255.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-142.91.15.0,142.91.15.255-146.0.200.0,148.0.0.0-149.255.255.255,150.0.0.0-172.255.15.0,172.255.15.255-173.244.0.0,173.245.213.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-198.20.103.0,198.20.103.255-206.191.156.0,206.191.156.255-212.39.68.0,212.39.68.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(5)) //cod mw3 or mw2, USA
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.47.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.17.0,24.105.17.255-24.105.29.75,24.105.29.77-24.105.52.0,24.105.52.255-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-40.0.0.0,41.0.0.0-45.32.209.0,45.32.209.255-45.63.46.0,45.63.47.255-45.77.118.0,45.77.118.255-52.0.0.0,53.0.0.0-57.9.0.0,57.55.55.55-66.42.88.0,66.42.88.255-66.115.177.0,66.115.177.255-66.115.191.0,66.115.191.255-67.27.0.0,67.28.0.0-68.232.170.0,68.232.170.255-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-96.30.200.0,96.30.200.255-104.156.236.0,104.156.236.255-104.156.240.0,104.156.240.255-107.181.171.0,107.181.171.255-107.182.226.0,107.182.226.255-107.182.230.0,107.182.230.255-108.61.32.0,108.61.36.255-108.61.128.0,108.61.128.255-108.61.133.0,108.61.133.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-140.82.30.0,140.82.30.255-144.202.32.0,144.202.32.255-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-172.83.41.0,172.83.42.0-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-204.74.253.0,204.74.253.255-206.190.154.0,206.190.154.255-208.167.253.0,208.167.253.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(6)) //cod mw3 or mw2, UK
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-31.24.224.0,31.24.224.255-31.186.229.0,31.186.229.255-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,35.244.54.255-40.1.1.1,41.0.0.0-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-78.129.138.0,78.129.255.255-82.145.41.0,82.145.41.255-82.145.63.0,82.145.63.255-87.117.231.0,87.117.231.255-88.0.186.0,88.202.186.255-94.0.0.0,94.0.0.1-95.154.221.0,95.154.255.255-95.179.204.0,95.179.205.255-104.238.169.0,104.238.169.255-107.152.106.113,107.152.106.115-109.123.102.0,109.123.102.255-109.169.0.0,109.169.255.255-109.200.30.0,109.200.30.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-176.227.219.0,176.227.219.255-185.19.215.254,185.19.215.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-185.80.223.0,185.80.223.255-185.254.70.0,185.254.70.255-192.168.0.0,192.170.0.0-212.78.0.0,212.78.0.255-212.78.82.0,212.78.83.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(7)) //cod mw3 or mw2, NL
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.51.36.255,13.0.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-23.109.54.0,23.109.54.255-23.109.78.0,23.109.80.255-23.109.84.0,23.109.84.255-24.105.29.75,24.105.29.77-24.105.53.0,24.105.53.255-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-52.0.0.0,53.0.0.0-64.95.100.0,64.95.100.255-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-198.20.103.0,198.20.103.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(8)) //cod mw3 or mw2, GER
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-31.186.229.0,31.186.229.255-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.0.0,37.244.255.255-40.1.1.1,41.0.0.0-45.63.118.0,45.63.118.255-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-85.195.79.0,85.195.120.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-146.0.200.0,148.0.0.0-149.255.255.255,150.0.0.0-173.244.0.0,173.245.213.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-212.39.68.0,212.39.68.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(9)) //cod mw3 or mw2, FRA
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-40.1.1.1,41.0.0.0-45.63.102.0,45.63.114.0-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-92.42.110.0,92.42.111.255-92.204.186.0,92.204.187.255-94.0.0.0,94.0.0.1-108.61.237.0,108.61.237.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-151.106.16.0,151.106.16.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-185.136.0.0,185.136.168.0-192.168.0.0,192.170.0.0-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(10)) //cod mw3 or mw2, EU
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.53.0,24.105.54.255-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-52.0.0.0,53.0.0.0-64.95.100.0,64.95.100.255-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-92.204.187.0,92.204.187.255-94.0.0.0,94.0.0.1-108.61.97.0,108.61.97.255-109.169.66.0,109.169.66.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-172.255.9.0,172.255.9.255-185.19.216.0,185.19.218.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-198.20.103.0,198.20.103.255-198.20.114.0,198.20.114.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(11)) //cod mw3 or mw2, BRAZIL
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-40.0.0.0,41.0.0.0-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-177.54.0.0,177.54.255.255-179.113.0.0,179.113.255.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-189.1.150.0,189.1.200.255-192.168.0.0,192.170.0.0-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(12)) //cod mw3 or mw2, SINGAPORE
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 2.0.0.0-8.0.0.0,9.0.0.0-10.0.0.0,11.0.0.0-13.244.0.0,13.244.0.0-13.255.255.255,14.0.0.0-15.0.0.0,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.28.100-40.0.0.0,41.0.0.0-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-95.177.146.0,95.177.146.255-103.126.138.0,103.126.138.255-137.221.0.0,137.223.0.0-139.0.0.0,140.0.0.0-146.0.234.0,146.0.245.0-146.0.245.255,148.0.0.0-149.28.185.255,150.0.0.0-157.175.1.0,157.175.94.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(13)) //cod mw3 or mw2, USA EAST
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.52.0,24.105.52.255-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-40.0.0.0,41.0.0.0-45.32.209.0,45.32.209.255-45.63.46.0,45.63.47.255-45.77.118.0,45.77.118.255-52.0.0.0,53.0.0.0-66.42.88.0,66.42.88.255-67.27.0.0,67.28.0.0-68.232.170.0,68.232.170.255-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-96.30.200.0,96.30.200.255-104.156.240.0,104.156.240.255-104.238.139.0,104.238.139.255-107.182.226.0,107.182.226.255-107.182.230.0,107.182.230.255-108.61.32.0,108.61.36.255-108.61.128.0,108.61.128.255-108.61.133.0,108.61.133.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-140.82.30.0,140.82.30.255-144.202.32.0,144.202.32.255-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-172.83.41.0,172.83.42.0-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-206.190.154.0,206.190.154.255-208.167.253.0,208.167.253.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(14)) //cod mw3 or mw2, USA WEST
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.17.0,24.105.17.255-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-40.0.0.0,41.0.0.0-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-69.88.157.0,69.88.157.255-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-104.156.228.0,104.156.228.255-104.238.142.0,104.238.142.255-107.191.59.0,107.191.59.255-108.61.235.0,108.61.235.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-142.54.238.0,142.54.238.255-147.255.255.255,148.0.0.0-148.72.171.0,148.72.171.255-149.28.198.0,149.28.198.255-149.28.216.0,149.28.216.255-149.248.24.0,149.248.24.255-149.248.40.0,149.248.42.255-149.255.255.255,150.0.0.0-155.138.178.0,155.138.178.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-192.252.212.0,192.252.212.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(15)) //cod mw3 or mw2, TEXAS
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-40.0.0.0,41.0.0.0-52.0.0.0,53.0.0.0-66.115.177.0,66.115.177.255-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-104.156.236.0,104.156.236.255-104.232.36.0,104.232.36.255-107.152.102.0,107.152.102.255-107.181.171.0,107.181.173.255-108.61.111.0,108.61.111.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-173.199.97.0,173.199.97.255-173.233.145.0,173.233.145.255-173.237.74.0,173.237.74.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-204.74.253.0,204.74.253.255-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(16)) //cod mw3 or mw2, SPAIN
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.28.0,37.244.54.255-40.0.0.0,41.0.0.0-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.255,82.145.63.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-108.61.97.0,108.61.97.255-137.221.0.0,137.223.0.0-139.255.255.255,140.0.0.0-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
                else if ((gameComboBox.SelectedIndex.Equals(3) || gameComboBox.SelectedIndex.Equals(2)) && regionComboBox.SelectedIndex.Equals(17)) //cod mw3 or mw2, ITALY
                {
                    string enableGeoBlockCommand = codMW2022 + $"\"{gamePath}\" -RemoteAddress 5.0.0.0-5.255.255.255,11.0.0.0-13.47.27.255,13.48.28.0-13.48.255.255,13.49.70.0-13.49.100.255,13.49.138.0-13.49.138.255,13.49.140.255-13.49.255.255,13.50.0.0-13.51.35.255,13.51.36.0-13.100.100.100,13.244.0.0-13.255.255.255,14.0.0.0-15.255.255.255,16.0.0.0-23.109.5.0,23.109.5.0-23.205.49.0,23.205.49.255-24.105.29.75,24.105.29.77-24.105.55.0,24.105.55.1-34.120.203.0,34.120.203.255-34.125.9.0,34.125.9.255-37.244.0.0,37.244.255.255-40.0.0.0,41.0.0.0-52.0.0.0,53.0.0.0-67.27.0.0,67.28.0.0-78.129.138.0,78.129.138.1-82.145.63.254,82.145.63.255-87.117.231.0,87.117.231.0-94.0.0.0,94.0.0.1-95.141.32.0,95.141.40.255-108.61.102.0,108.61.102.255-137.221.0.0,137.223.0.0-138.199.44.0,138.199.44.255-139.255.255.255,140.0.0.0-147.255.255.255,148.0.0.0-149.255.255.255,150.0.0.0-158.58.172.0,158.58.172.255-185.19.216.0,185.19.216.255-185.34.0.0,185.80.0.0-192.168.0.0,192.170.0.0-212.78.0.0,212.78.0.255-255.255.255.255";
                    ExecutePowerShellCommand(enableGeoBlockCommand);
                }
            }
        }

        private void disable_button_Click(object sender, EventArgs e)
        {
            string disableGeoBlockCommand = "Remove-NetFirewallRule -DisplayName \"220822\" -ErrorAction SilentlyContinue;\r\nRemove-NetFirewallRule -DisplayName \"warzone2_221119\""; //only mw3 beta/mw2 working
            ExecutePowerShellCommand(disableGeoBlockCommand);
        }

        private void ExecutePowerShellCommand(string command)
        {
            try
            {
                ProcessStartInfo processInfo = new ProcessStartInfo
                {
                    FileName = "powershell.exe",
                    RedirectStandardInput = true,
                    RedirectStandardOutput = true,
                    RedirectStandardError = true,
                    UseShellExecute = false,
                    CreateNoWindow = true,
                    Verb = "runas"
                };

                Process process = new Process
                {
                    StartInfo = processInfo,
                    EnableRaisingEvents = true
                };

                process.Start();
                process.BeginOutputReadLine();
                process.BeginErrorReadLine();

                using (StreamWriter streamWriter = process.StandardInput)
                {
                    if (streamWriter.BaseStream.CanWrite)
                    {
                        streamWriter.WriteLine(command);
                    }
                }

                process.WaitForExit();
                process.Close();
                MessageBox.Show("Command executed successfully.");
            }
            catch (Exception ex)
            {
                MessageBox.Show("Error: " + ex.Message);
            }
        }
    }
}